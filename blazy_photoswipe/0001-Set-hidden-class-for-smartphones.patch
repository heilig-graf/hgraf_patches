From 05d244bbb541f070d624b94e5a36559c830fd813 Mon Sep 17 00:00:00 2001
From: timlievens <tim.lievens@heilig-graf.be>
Date: Fri, 30 Apr 2021 08:50:11 +0200
Subject: [PATCH] Set hidden class for smartphones

---
 js/blazy.photoswipe.js     | 2 +-
 js/blazy.photoswipe.min.js | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/js/blazy.photoswipe.js b/js/blazy.photoswipe.js
index 5c21044..a5a143d 100644
--- a/js/blazy.photoswipe.js
+++ b/js/blazy.photoswipe.js
@@ -314,7 +314,7 @@
 
     if (media.type === 'video') {
       html += '<img src="' + boxUrl + '" class="media__image media__element pswp__img" alt="' + Drupal.t(alt) + '"/>';
-      html += '<span class="media__icon media__icon--close"></span>';
+      html += '<span hidden class="media__icon media__icon--close"></span>';
       html += '<span class="media__icon media__icon--play" data-url="' + oembedUrl + '"></span>';
     }
 
diff --git a/js/blazy.photoswipe.min.js b/js/blazy.photoswipe.min.js
index f742618..036a504 100644
--- a/js/blazy.photoswipe.min.js
+++ b/js/blazy.photoswipe.min.js
@@ -1 +1 @@
-!function(e,t,i,a,r,n,o){"use strict";function l(l,s){function c(t,i){var a=null!==t.nextElementSibling?t.nextElementSibling:null,n=t.getAttribute("data-media")?r.parse(t.getAttribute("data-media")):{},o=t.getAttribute("href"),l=t.getAttribute("data-thumb")?t.getAttribute("data-thumb"):"",p={},s="";p.el=t,p.w=n.width,p.h=n.height,p.i=i,p.type=n.type,null!==a&&(p.title=a.innerHTML),l&&(p.msrc=l),"image"===n.type?p.src=o:"rich"===n.type?("html"in n?s=n.html:t.hasAttribute("data-b-rich")&&(s=r.parse(t.getAttribute("data-b-rich"))),p.html=e.theme("blazyPhotoSwipe",{html:s,media:p})):(s=e.theme("blazyPhotoSwipeMedia",{item:p}),p.html=e.theme("blazyPhotoSwipe",{html:s,media:p})),f.push(p)}function u(e){var t=0;return r.forEach(b,function(i,a){if(i===e)return t=a,!1}),t}function d(e){e.preventDefault();var t=e.target;h(u(t.parentNode.getAttribute("href")?t.parentNode:r.closest(t,"[data-photoswipe-trigger]")))}function h(t){t=t>0?t:0,g.index=t,g.clickToCloseNonZoomable=!1,g.galleryUID=l.getAttribute("data-pswp-uid"),g.getThumbBoundsFn=function(e){var t=n.pageYOffset||o.documentElement.scrollTop,i=f[e].el.getBoundingClientRect();return{x:i.left,y:i.top+t,w:i.width}};var r=new i(w,a,f,g);r.listen("beforeChange",function(){e.attachBehaviors(w)}),r.listen("afterChange",function(){if(m(),"video"===r.currItem.type){var e=r.currItem.container.querySelector(".media__icon--play");null!==e&&(n.clearTimeout(p),p=n.setTimeout(function(){e.click()},300))}}),r.listen("pointerDown",function(){w.className+=" pswp--dragging"}),r.listen("pointerUp",function(){w.className.match("pswp--dragging")&&(w.className=w.className.replace(/(\S+)pswp--dragging/,""))}),r.listen("close",function(){m()}),r.init()}function m(){var e,t;null!==w.querySelector(".is-playing")&&null!==(e=w.querySelector(".is-playing .media__icon--close"))&&r.trigger(e,"click"),null!==(t=w.querySelector("video"))&&t.pause()}var g=t.photoswipe.options||{},w=o.querySelectorAll(".pswp")[0],b=l.querySelectorAll("[data-photoswipe-trigger]"),f=[];r.forEach(b,c,l),l.setAttribute("data-pswp-uid",s+1),r.on(l,"click","[data-photoswipe-trigger]",d);var y=function(){var e=n.location.hash.substring(1),t={};if(e.length<5)return t;for(var i=e.split("&"),a=0;a<i.length;a++)if(i[a]){var r=i[a].split("=");r.length<2||(t[r[0]]=r[1])}return Object.prototype.hasOwnProperty.call(t,"pid")?(t.pid=parseInt(t.pid,10),t):t}();y.pid>0&&!w.className.match("pswp--open")&&h(y.pid-1),l.className+=" photoswipe--on"}var p;e.theme.blazyPhotoSwipe=function(e){var t,i=e.media;return t='<div class="pswp__item--html media-wrapper" style="width:'+i.w+'px">',t+=e.html,t+="</div>"},e.theme.blazyPhotoSwipeMedia=function(t){var i,a=t.item,r=a.el,n=r.querySelector("img"),o=null!==n?n.getAttribute("alt"):"",l=(a.h/a.w*100).toFixed(2),p=r.getAttribute("data-box-url"),s=r.getAttribute("href"),c=r.hasAttribute("data-oembed-url")?r.getAttribute("data-oembed-url"):s,u="video"===a.type?" media--player":"";return i='<div class="media media--pswp media--switch'+u+' media--ratio media--ratio--fluid" style="padding-bottom: '+l+'%">',"video"===a.type&&(i+='<img src="'+p+'" class="media__image media__element pswp__img" alt="'+e.t(o)+'"/>',i+='<span class="media__icon media__icon--close"></span>',i+='<span class="media__icon media__icon--play" data-url="'+c+'"></span>'),i+='<iframe src="about:blank" data-src="'+c+'" width="'+a.w+'" height="'+a.h+'" class="b-lazy media__iframe media__element" allowfullscreen></iframe>',i+="</div>"},e.behaviors.blazyPhotoSwipe={attach:function(e){var i=o.querySelector(".pswp");Object.prototype.hasOwnProperty.call(t.photoswipe,"container")&&null===i&&o.body.insertAdjacentHTML("beforeend",t.photoswipe.container);var a=e.querySelectorAll("[data-photoswipe-gallery]:not(.photoswipe--on)");r.once(r.forEach(a,l,e))}}}(Drupal,drupalSettings,PhotoSwipe,PhotoSwipeUI_Default,dBlazy,this,this.document);
+!function(e,t,i,a,r,n,o){"use strict";function l(l,s){function c(t,i){var a=null!==t.nextElementSibling?t.nextElementSibling:null,n=t.getAttribute("data-media")?r.parse(t.getAttribute("data-media")):{},o=t.getAttribute("href"),l=t.getAttribute("data-thumb")?t.getAttribute("data-thumb"):"",p={},s="";p.el=t,p.w=n.width,p.h=n.height,p.i=i,p.type=n.type,null!==a&&(p.title=a.innerHTML),l&&(p.msrc=l),"image"===n.type?p.src=o:"rich"===n.type?("html"in n?s=n.html:t.hasAttribute("data-b-rich")&&(s=r.parse(t.getAttribute("data-b-rich"))),p.html=e.theme("blazyPhotoSwipe",{html:s,media:p})):(s=e.theme("blazyPhotoSwipeMedia",{item:p}),p.html=e.theme("blazyPhotoSwipe",{html:s,media:p})),f.push(p)}function u(e){var t=0;return r.forEach(b,function(i,a){if(i===e)return t=a,!1}),t}function d(e){e.preventDefault();var t=e.target;h(u(t.parentNode.getAttribute("href")?t.parentNode:r.closest(t,"[data-photoswipe-trigger]")))}function h(t){t=t>0?t:0,g.index=t,g.clickToCloseNonZoomable=!1,g.galleryUID=l.getAttribute("data-pswp-uid"),g.getThumbBoundsFn=function(e){var t=n.pageYOffset||o.documentElement.scrollTop,i=f[e].el.getBoundingClientRect();return{x:i.left,y:i.top+t,w:i.width}};var r=new i(w,a,f,g);r.listen("beforeChange",function(){e.attachBehaviors(w)}),r.listen("afterChange",function(){if(m(),"video"===r.currItem.type){var e=r.currItem.container.querySelector(".media__icon--play");null!==e&&(n.clearTimeout(p),p=n.setTimeout(function(){e.click()},300))}}),r.listen("pointerDown",function(){w.className+=" pswp--dragging"}),r.listen("pointerUp",function(){w.className.match("pswp--dragging")&&(w.className=w.className.replace(/(\S+)pswp--dragging/,""))}),r.listen("close",function(){m()}),r.init()}function m(){var e,t;null!==w.querySelector(".is-playing")&&null!==(e=w.querySelector(".is-playing .media__icon--close"))&&r.trigger(e,"click"),null!==(t=w.querySelector("video"))&&t.pause()}var g=t.photoswipe.options||{},w=o.querySelectorAll(".pswp")[0],b=l.querySelectorAll("[data-photoswipe-trigger]"),f=[];r.forEach(b,c,l),l.setAttribute("data-pswp-uid",s+1),r.on(l,"click","[data-photoswipe-trigger]",d);var y=function(){var e=n.location.hash.substring(1),t={};if(e.length<5)return t;for(var i=e.split("&"),a=0;a<i.length;a++)if(i[a]){var r=i[a].split("=");r.length<2||(t[r[0]]=r[1])}return Object.prototype.hasOwnProperty.call(t,"pid")?(t.pid=parseInt(t.pid,10),t):t}();y.pid>0&&!w.className.match("pswp--open")&&h(y.pid-1),l.className+=" photoswipe--on"}var p;e.theme.blazyPhotoSwipe=function(e){var t,i=e.media;return t='<div class="pswp__item--html media-wrapper" style="width:'+i.w+'px">',t+=e.html,t+="</div>"},e.theme.blazyPhotoSwipeMedia=function(t){var i,a=t.item,r=a.el,n=r.querySelector("img"),o=null!==n?n.getAttribute("alt"):"",l=(a.h/a.w*100).toFixed(2),p=r.getAttribute("data-box-url"),s=r.getAttribute("href"),c=r.hasAttribute("data-oembed-url")?r.getAttribute("data-oembed-url"):s,u="video"===a.type?" media--player":"";return i='<div class="media media--pswp media--switch'+u+' media--ratio media--ratio--fluid" style="padding-bottom: '+l+'%">',"video"===a.type&&(i+='<img src="'+p+'" class="media__image media__element pswp__img" alt="'+e.t(o)+'"/>',i+='<span hidden class="media__icon media__icon--close"></span>',i+='<span class="media__icon media__icon--play" data-url="'+c+'"></span>'),i+='<iframe src="about:blank" data-src="'+c+'" width="'+a.w+'" height="'+a.h+'" class="b-lazy media__iframe media__element" allowfullscreen></iframe>',i+="</div>"},e.behaviors.blazyPhotoSwipe={attach:function(e){var i=o.querySelector(".pswp");Object.prototype.hasOwnProperty.call(t.photoswipe,"container")&&null===i&&o.body.insertAdjacentHTML("beforeend",t.photoswipe.container);var a=e.querySelectorAll("[data-photoswipe-gallery]:not(.photoswipe--on)");r.once(r.forEach(a,l,e))}}}(Drupal,drupalSettings,PhotoSwipe,PhotoSwipeUI_Default,dBlazy,this,this.document);
-- 
2.25.1

