From c6ff485d4e42e738b4e7ef4bee732b68693e256c Mon Sep 17 00:00:00 2001
From: Tim Lievens <timlievens@gmail.com>
Date: Mon, 25 May 2020 08:49:31 +0200
Subject: [PATCH] Set hidden class for smartphones

---
 js/blazy.photoswipe.js     | 2 +-
 js/blazy.photoswipe.min.js | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/js/blazy.photoswipe.js b/js/blazy.photoswipe.js
index 5480a3f..e98c9cf 100644
--- a/js/blazy.photoswipe.js
+++ b/js/blazy.photoswipe.js
@@ -277,7 +277,7 @@
 
     if (item.type === 'video') {
       html += '<img src="' + boxUrl + '" class="media__image media__element pswp__img" alt="' + Drupal.t(alt) + '"/>';
-      html += '<span class="media__icon media__icon--close"></span>';
+      html += '<span hidden class="media__icon media__icon--close"></span>';
       html += '<span class="media__icon media__icon--play" data-url="' + oembedUrl + '"></span>';
     }
 
diff --git a/js/blazy.photoswipe.min.js b/js/blazy.photoswipe.min.js
index 7317ca8..6aa3a84 100644
--- a/js/blazy.photoswipe.min.js
+++ b/js/blazy.photoswipe.min.js
@@ -1 +1 @@
-!function(e,t,i,a,r,n,o){"use strict";function l(l,p){function c(t,i){var a=null!==t.nextElementSibling?t.nextElementSibling:null,n=t.getAttribute("data-media")?r.parse(t.getAttribute("data-media")):{},o=t.getAttribute("href"),l=t.getAttribute("data-thumb")?t.getAttribute("data-thumb"):"",s={};s.el=t,s.w=n.width,s.h=n.height,s.i=i,s.type=n.type,null!==a&&(s.title=a.innerHTML),l&&(s.msrc=l),"image"===n.type?s.src=o:"rich"===n.type&&t.hasAttribute("data-b-rich")?s.html=r.parse(t.getAttribute("data-b-rich")):s.html=e.theme("blazyPhotoSwipeMedia",{item:s}),b.push(s)}function u(e){var t=0;return r.forEach(w,function(i,a){if(i===e)return t=a,!1}),t}function d(e){e.preventDefault();var t=e.target;h(u(t.parentNode.getAttribute("href")?t.parentNode:r.closest(t,"[data-photoswipe-trigger]")))}function h(t){t=t>0?t:0,g.index=t,g.clickToCloseNonZoomable=!1,g.galleryUID=l.getAttribute("data-pswp-uid"),g.getThumbBoundsFn=function(e){var t=n.pageYOffset||o.documentElement.scrollTop,i=b[e].el.getBoundingClientRect();return{x:i.left,y:i.top+t,w:i.width}};var r=new i(f,a,b,g);r.listen("beforeChange",function(){e.attachBehaviors(f)}),r.listen("afterChange",function(){if(m(),n.clearTimeout(s),"video"===r.currItem.type){var e=r.currItem.container.querySelector(".media__icon--play");null!==e&&(s=n.setTimeout(function(){e.click()},300))}}),r.listen("pointerDown",function(){f.className+=" pswp--dragging"}),r.listen("pointerUp",function(){f.className.match("pswp--dragging")&&(f.className=f.className.replace(/(\S+)pswp--dragging/,""))}),r.listen("close",function(){m()}),r.init()}function m(){var e=f.querySelector(".is-playing .media__icon--close"),t=f.querySelector("video");null!==e&&r.trigger(e,"click"),null!==t&&t.pause()}var g=t.photoswipe.options||{},f=o.querySelectorAll(".pswp")[0],w=l.querySelectorAll("[data-photoswipe-trigger]"),b=[];r.forEach(w,c,l),l.setAttribute("data-pswp-uid",p+1),r.on(f,"click",".pswp__button",m),r.on(l,"click","[data-photoswipe-trigger]",d);var y=function(){var e=n.location.hash.substring(1),t={};if(e.length<5)return t;for(var i=e.split("&"),a=0;a<i.length;a++)if(i[a]){var r=i[a].split("=");r.length<2||(t[r[0]]=r[1])}return t.hasOwnProperty("pid")?(t.pid=parseInt(t.pid,10),t):t}();y.pid>0&&!f.className.match("pswp--open")&&h(y.pid-1),l.className+=" photoswipe--on"}var s;e.theme.blazyPhotoSwipeMedia=function(t){var i,a=t.item,r=a.el,n=r.querySelector("img"),o=null!==n?n.getAttribute("alt"):"",l=Math.round(a.h/a.w*100,2),s=r.getAttribute("data-box-url"),p=r.getAttribute("href"),c=r.hasAttribute("data-oembed-url")?r.getAttribute("data-oembed-url"):p,u="video"===a.type?" media--player":"";return i='<div class="pswp__item--html media-wrapper" style="width:'+a.w+'px">',i+='<div class="media media--pswp media--switch'+u+' media--ratio media--ratio--fluid" style="padding-bottom: '+l+'%">',"video"===a.type&&(i+='<img src="'+s+'" class="media__image media__element pswp__img" alt="'+e.t(o)+'"/>',i+='<span class="media__icon media__icon--close"></span>',i+='<span class="media__icon media__icon--play" data-url="'+c+'"></span>'),i+='<iframe src="about:blank" data-src="'+c+'" width="'+a.w+'" height="'+a.h+'" class="b-lazy media__iframe media__element" allowfullscreen></iframe>',i+="</div></div>"},e.behaviors.blazyPhotoSwipe={attach:function(e){var i=o.querySelector(".pswp");t.photoswipe.hasOwnProperty("container")&&null===i&&o.body.insertAdjacentHTML("beforeend",t.photoswipe.container);var a=e.querySelectorAll("[data-photoswipe-gallery]:not(.photoswipe--on)");r.once(r.forEach(a,l,e))}}}(Drupal,drupalSettings,PhotoSwipe,PhotoSwipeUI_Default,dBlazy,this,this.document);
+!function(e,t,i,a,r,n,o){"use strict";function l(l,p){function c(t,i){var a=null!==t.nextElementSibling?t.nextElementSibling:null,n=t.getAttribute("data-media")?r.parse(t.getAttribute("data-media")):{},o=t.getAttribute("href"),l=t.getAttribute("data-thumb")?t.getAttribute("data-thumb"):"",s={};s.el=t,s.w=n.width,s.h=n.height,s.i=i,s.type=n.type,null!==a&&(s.title=a.innerHTML),l&&(s.msrc=l),"image"===n.type?s.src=o:"rich"===n.type&&t.hasAttribute("data-b-rich")?s.html=r.parse(t.getAttribute("data-b-rich")):s.html=e.theme("blazyPhotoSwipeMedia",{item:s}),b.push(s)}function u(e){var t=0;return r.forEach(w,function(i,a){if(i===e)return t=a,!1}),t}function d(e){e.preventDefault();var t=e.target;h(u(t.parentNode.getAttribute("href")?t.parentNode:r.closest(t,"[data-photoswipe-trigger]")))}function h(t){t=t>0?t:0,g.index=t,g.clickToCloseNonZoomable=!1,g.galleryUID=l.getAttribute("data-pswp-uid"),g.getThumbBoundsFn=function(e){var t=n.pageYOffset||o.documentElement.scrollTop,i=b[e].el.getBoundingClientRect();return{x:i.left,y:i.top+t,w:i.width}};var r=new i(f,a,b,g);r.listen("beforeChange",function(){e.attachBehaviors(f)}),r.listen("afterChange",function(){if(m(),n.clearTimeout(s),"video"===r.currItem.type){var e=r.currItem.container.querySelector(".media__icon--play");null!==e&&(s=n.setTimeout(function(){e.click()},300))}}),r.listen("pointerDown",function(){f.className+=" pswp--dragging"}),r.listen("pointerUp",function(){f.className.match("pswp--dragging")&&(f.className=f.className.replace(/(\S+)pswp--dragging/,""))}),r.listen("close",function(){m()}),r.init()}function m(){var e=f.querySelector(".is-playing .media__icon--close"),t=f.querySelector("video");null!==e&&r.trigger(e,"click"),null!==t&&t.pause()}var g=t.photoswipe.options||{},f=o.querySelectorAll(".pswp")[0],w=l.querySelectorAll("[data-photoswipe-trigger]"),b=[];r.forEach(w,c,l),l.setAttribute("data-pswp-uid",p+1),r.on(f,"click",".pswp__button",m),r.on(l,"click","[data-photoswipe-trigger]",d);var y=function(){var e=n.location.hash.substring(1),t={};if(e.length<5)return t;for(var i=e.split("&"),a=0;a<i.length;a++)if(i[a]){var r=i[a].split("=");r.length<2||(t[r[0]]=r[1])}return t.hasOwnProperty("pid")?(t.pid=parseInt(t.pid,10),t):t}();y.pid>0&&!f.className.match("pswp--open")&&h(y.pid-1),l.className+=" photoswipe--on"}var s;e.theme.blazyPhotoSwipeMedia=function(t){var i,a=t.item,r=a.el,n=r.querySelector("img"),o=null!==n?n.getAttribute("alt"):"",l=Math.round(a.h/a.w*100,2),s=r.getAttribute("data-box-url"),p=r.getAttribute("href"),c=r.hasAttribute("data-oembed-url")?r.getAttribute("data-oembed-url"):p,u="video"===a.type?" media--player":"";return i='<div class="pswp__item--html media-wrapper" style="width:'+a.w+'px">',i+='<div class="media media--pswp media--switch'+u+' media--ratio media--ratio--fluid" style="padding-bottom: '+l+'%">',"video"===a.type&&(i+='<img src="'+s+'" class="media__image media__element pswp__img" alt="'+e.t(o)+'"/>',i+='<span hidden class="media__icon media__icon--close"></span>',i+='<span class="media__icon media__icon--play" data-url="'+c+'"></span>'),i+='<iframe src="about:blank" data-src="'+c+'" width="'+a.w+'" height="'+a.h+'" class="tim b-lazy media__iframe media__element" allowfullscreen></iframe>',i+="</div></div>"},e.behaviors.blazyPhotoSwipe={attach:function(e){var i=o.querySelector(".pswp");t.photoswipe.hasOwnProperty("container")&&null===i&&o.body.insertAdjacentHTML("beforeend",t.photoswipe.container);var a=e.querySelectorAll("[data-photoswipe-gallery]:not(.photoswipe--on)");r.once(r.forEach(a,l,e))}}}(Drupal,drupalSettings,PhotoSwipe,PhotoSwipeUI_Default,dBlazy,this,this.document);
-- 
2.16.3

